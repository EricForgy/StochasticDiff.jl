var documenterSearchIndex = {"docs":
[{"location":"#StochasticDiff.jl-1","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"This is a simple package to demonstrate the extension of automatic differentiation to stochastic processes.","category":"page"},{"location":"#Background-1","page":"StochasticDiff.jl","title":"Background","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Give any two functions f and g, a derivation d is a nilpotent map satisfying the product rule","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"d(fg) = (df)g + f(dg)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"We observe that d(fg) can be determined if we know, not just f and g, but the pairs (fdf) and (gdg).","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Since f and g are functions and df and dg are covector fields on some space, then the pairs (fdf) and (gdg) represent covector fields on a larger total space.","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Let pi denote a projection map given by","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"pi(fdf) = f","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"For a given derivation d, we have the inverse map","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"pi^-1 f = (fdf)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"We introduce a product of (fdf) and (gdg) by insisting that pi^-1 be an algebra homomorphism, i.e.","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"so that","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"beginaligned(fdf)(gdg) = (fgd(fg))  = (fg(df)g+f(dg))endaligned","category":"page"},{"location":"#Newtonian-Processes-1","page":"StochasticDiff.jl","title":"Newtonian Processes","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Consider a (1+1)-dimensional Newtonian process","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"df = (partial_x f) dx + (partial_t f) dt","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"The corresponding covector (fdf) can be expanded to","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"(fdf) = (f(partial_x f)dx) + (f(partial_t f)dt)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"indicating the process can be encoded into a struct","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"struct Newtonian{F,dFdx,dFdt}\r\n    f::F\r\n    dfdx::dFdx\r\n    dfdt::dFdt\r\nend","category":"page"},{"location":"#Example:-Geometric-Linear-Motion-1","page":"StochasticDiff.jl","title":"Example: Geometric Linear Motion","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Consider a simple (1+1)-dimensional differential equation","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"df = alpha f dx + beta f dt","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"with closed-form solution","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"f(xt) = f_0 expleft(alpha x + beta tright)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"The partial derivatives of f(xt) are","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"partial_x f(xt) = alpha f(xt)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"and","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"partial_t f(xt) = beta f(xy)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"For concreteness, let alpha = 3, beta = 4 and f(00) = 1 so we have:","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> f(x,t) = exp(3*x+4*t)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"with","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"partial_x f = 3quadtextandquadpartial_t f = 4","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Next, define:","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"pi^-1f(xt) = fleftpi^-1(x)pi^-1(t)right","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"or","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> fnewt(x,t) = f(Newtonian(x,1,0),Newtonian(t,0,1))","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"which comes from","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"pi^-1(x) = (xdx) = Newtonian(x10)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"and","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"pi^-1(t) = (tdt) = Newtonian(t01)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Evaluating","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> fnewt(0,0)\r\nNewtonian:\r\n  f: 1.0\r\n  dfdx: 3.0 # alpha\r\n  dfdt: 4.0 # beta","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"as expected.","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Furthermore,","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> x = rand(); t = rand(); fnewt(x,t)/fnewt(x,t).f\r\nNewtonian:\r\n  f: 1.0\r\n  dfdx: 3.0 # alpha\r\n  dfdt: 4.0 # beta","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"also as expected.","category":"page"},{"location":"#Stochastic-Processes-1","page":"StochasticDiff.jl","title":"Stochastic Processes","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Finally, consider the (1+1)-dimensional stochastic process","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"df = (partial_x f) dx + (partial_t f + frac12 partial_x^2 f) dt","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Like the Newtonian process above, the stochastic process can be encoded into a struct","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"struct Stochastic{F,dFdx,dFdt}\r\n    f::F\r\n    dfdx::dFdx\r\n    dfdt::dFdt\r\nend","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Stochastic processes are also amenable to automatic differentiate with some minor revisions.","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"To see this, first rewrite the above process as","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"df = (partial_x f) dx + (widetildepartial_t f) dt","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"where","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"widetildepartial_t = partial_t + frac12 partial_x^2","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"The operator widetildepartial_t does not satisfy the usual product rule of partial derivatives. Instead, it satisfies","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"widetildepartial_t(fg) = (widetildepartial_t f)g + f(widetildepartial_t g) + (partial_x f)(partial_x g)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Therefore, we have","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Base.:*(x::Stochastic,y::Stochastic) =\r\n    Stochastic(\r\n        x.f*y.f,\r\n        x.f*y.dfdx + x.dfdx*y.f,\r\n        x.f*y.dfdt + x.dfdt*y.f + x.dfdx*y.dfdx\r\n    )","category":"page"},{"location":"#Example:-Geometric-Brownian-Motion-1","page":"StochasticDiff.jl","title":"Example: Geometric Brownian Motion","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Consider geometric Brownian motion in (1+1)-dimensions given by the stochastic differential equation","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"dS = mu S dt + sigma S dx","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"with closed-form solution","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"S(xt) = S_0 expleftsigma x + (mu-fracsigma^22)tright","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"The partial derivatives are","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"partial_x S(xt) = sigma S(xt)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"and","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"widetildepartial_t S(xt) = left(partial_t + frac12partial^2_x right) S(xt) = mu S(xt)","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Note the form of the solution to the stochastic differential equation coincides with the form of previous differential equation if","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"sigma = alpha = 3quadtextandquad mu = beta + fracalpha^22 = 85","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Therefore, we'll similarly define","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> fstoch(x,t) = f(Stochastic(x,1,0),Stochastic(t,0,1))","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Finally, we evaluate the function at x = 0 y = 0:","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> fstoch(0,0)\r\njulia> fstoch(0,0)\r\nStochastic:\r\n  f: 1.0\r\n  dfdx: 3.0 # mu\r\n  dfdt: 8.5 # sigma","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"and","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> x = rand(); t = rand(); fstoch(x,t)/fstoch(x,t).f\r\nStochastic:\r\n  f: 1.0\r\n  dfdx: 3.0 # mu\r\n  dfdt: 8.5 # sigma","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"as expected.","category":"page"},{"location":"#Sanity-Checks-1","page":"StochasticDiff.jl","title":"Sanity Checks","text":"","category":"section"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Check inverses:","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> x = Stochastic(rand(),rand(),rand())\r\nStochastic:\r\n  f: 0.6646540596826009\r\n  dfdx: 0.9674190744363276\r\n  dfdt: 0.1327748608375081\r\n\r\njulia> inv(x)\r\nStochastic:\r\n  f: 1.5045420778405239\r\n  dfdx: -2.189895154014495\r\n  dfdt: 2.886886719560768\r\n\r\njulia> 1.0/x\r\nStochastic:\r\n  f: 1.5045420778405239\r\n  dfdx: -2.189895154014495\r\n  dfdt: 2.886886719560768\r\n\r\njulia> x^(-1.0)\r\nStochastic:\r\n  f: 1.5045420778405239\r\n  dfdx: -2.189895154014495\r\n  dfdt: 2.886886719560768\r\n\r\njulia> inv(x)*x\r\nStochastic:\r\n  f: 1.0\r\n  dfdx: 2.220446049250313e-16\r\n  dfdt: -4.440892098500626e-16","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Check division:","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> y = Stochastic(rand(),rand(),rand())\r\nStochastic:\r\n  f: 0.24628623901245295\r\n  dfdx: 0.9421598146810133\r\n  dfdt: 0.4889415699838624\r\n\r\njulia> x/y\r\nStochastic:\r\n  f: 2.6987056294647225\r\n  dfdx: -6.39578129746468\r\n  dfdt: 34.67486911938278\r\n\r\njulia> x*y^(-1)\r\nStochastic:\r\n  f: 2.6987056294647225\r\n  dfdx: -6.395781297464681\r\n  dfdt: 19.648331286416997","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Check logleftexp(x)right == expleftlog(x)right == x:","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> exp(x)\r\nStochastic:\r\n  f: 1.9438179600084473\r\n  dfdx: 1.8804865717440824\r\n  dfdt: 1.167699448496872\r\n\r\njulia> log(x)\r\nStochastic:\r\n  f: -0.4084885846865794\r\n  dfdx: 1.4555227043949888\r\n  dfdt: -0.8595078064952\r\n\r\njulia> log(exp(x))\r\nStochastic:\r\n  f: 0.6646540596826009\r\n  dfdx: 0.9674190744363275\r\n  dfdt: 0.13277486083750817\r\n\r\njulia> log(exp(x))-x\r\nStochastic:\r\n  f: 0.0\r\n  dfdx: -1.1102230246251565e-16\r\n  dfdt: 5.551115123125783e-17\r\n\r\njulia> exp(log(x))-x\r\nStochastic:\r\n  f: 0.0\r\n  dfdx: 0.0\r\n  dfdt: 0.0","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"Check expleft-log(x)right = x^-1","category":"page"},{"location":"#","page":"StochasticDiff.jl","title":"StochasticDiff.jl","text":"julia> exp(-log(x))\r\nStochastic:\r\n  f: 1.5045420778405239\r\n  dfdx: -2.189895154014495\r\n  dfdt: 2.886886719560768\r\n\r\njulia> inv(x)\r\nStochastic:\r\n  f: 1.5045420778405239\r\n  dfdx: -2.189895154014495\r\n  dfdt: 2.886886719560768","category":"page"}]
}
